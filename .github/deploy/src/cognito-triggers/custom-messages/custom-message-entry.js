"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.main = void 0;
const custom_message_1 = require("./custom-message");
if (!process.env.FRONTEND_BASE_URL) {
    throw new Error('Environment variable FRONTEND_BASE_URL is required.');
}
function main(event, _context, callback) {
    const { triggerSource, request: { codeParameter, userAttributes, usernameParameter }, } = event;
    const customMessage = new custom_message_1.default({
        userAttributes,
        codeParameter,
        usernameParameter,
    });
    if (triggerSource === 'CustomMessage_SignUp' && userAttributes['cognito:user_status'] === 'UNCONFIRMED') {
        event.response = customMessage.sendCodePostSignUp();
    }
    // Return to Amazon Cognito
    callback(null, event);
}
exports.main = main;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VzdG9tLW1lc3NhZ2UtZW50cnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjdXN0b20tbWVzc2FnZS1lbnRyeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxxREFBNEM7QUFFNUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUU7SUFDbEMsTUFBTSxJQUFJLEtBQUssQ0FBQyxxREFBcUQsQ0FBQyxDQUFBO0NBQ3ZFO0FBc0JELFNBQWdCLElBQUksQ0FBQyxLQUFZLEVBQUUsUUFBaUIsRUFBRSxRQUFrQjtJQUN0RSxNQUFNLEVBQ0osYUFBYSxFQUNiLE9BQU8sRUFBRSxFQUFFLGFBQWEsRUFBRSxjQUFjLEVBQUUsaUJBQWlCLEVBQUUsR0FDOUQsR0FBRyxLQUFLLENBQUE7SUFFVCxNQUFNLGFBQWEsR0FBRyxJQUFJLHdCQUFhLENBQUM7UUFDdEMsY0FBYztRQUNkLGFBQWE7UUFDYixpQkFBaUI7S0FDbEIsQ0FBQyxDQUFBO0lBRUYsSUFBSSxhQUFhLEtBQUssc0JBQXNCLElBQUksY0FBYyxDQUFDLHFCQUFxQixDQUFDLEtBQUssYUFBYSxFQUFFO1FBQ3ZHLEtBQUssQ0FBQyxRQUFRLEdBQUcsYUFBYSxDQUFDLGtCQUFrQixFQUFFLENBQUE7S0FDcEQ7SUFFRCwyQkFBMkI7SUFDM0IsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtBQUN2QixDQUFDO0FBbEJELG9CQWtCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENhbGxiYWNrLCBDb250ZXh0IH0gZnJvbSAnYXdzLWxhbWJkYSdcbmltcG9ydCBDdXN0b21NZXNzYWdlIGZyb20gJy4vY3VzdG9tLW1lc3NhZ2UnXG5cbmlmICghcHJvY2Vzcy5lbnYuRlJPTlRFTkRfQkFTRV9VUkwpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdFbnZpcm9ubWVudCB2YXJpYWJsZSBGUk9OVEVORF9CQVNFX1VSTCBpcyByZXF1aXJlZC4nKVxufVxuXG50eXBlIEV2ZW50ID0ge1xuICB0cmlnZ2VyU291cmNlOiBzdHJpbmdcbiAgcmVxdWVzdDoge1xuICAgIGNvZGVQYXJhbWV0ZXI6IHN0cmluZ1xuICAgIHVzZXJBdHRyaWJ1dGVzOiB7XG4gICAgICAnY29nbml0bzp1c2VyX3N0YXR1cyc6IHN0cmluZ1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgICAgZ2l2ZW5fbmFtZTogc3RyaW5nXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgICBmYW1pbHlfbmFtZTogc3RyaW5nXG4gICAgICBlbWFpbDogc3RyaW5nXG4gICAgfVxuICAgIHVzZXJuYW1lUGFyYW1ldGVyOiBzdHJpbmdcbiAgfVxuICByZXNwb25zZToge1xuICAgIGVtYWlsU3ViamVjdDogc3RyaW5nXG4gICAgZW1haWxNZXNzYWdlOiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFpbihldmVudDogRXZlbnQsIF9jb250ZXh0OiBDb250ZXh0LCBjYWxsYmFjazogQ2FsbGJhY2spOiB2b2lkIHtcbiAgY29uc3Qge1xuICAgIHRyaWdnZXJTb3VyY2UsXG4gICAgcmVxdWVzdDogeyBjb2RlUGFyYW1ldGVyLCB1c2VyQXR0cmlidXRlcywgdXNlcm5hbWVQYXJhbWV0ZXIgfSxcbiAgfSA9IGV2ZW50XG5cbiAgY29uc3QgY3VzdG9tTWVzc2FnZSA9IG5ldyBDdXN0b21NZXNzYWdlKHtcbiAgICB1c2VyQXR0cmlidXRlcyxcbiAgICBjb2RlUGFyYW1ldGVyLFxuICAgIHVzZXJuYW1lUGFyYW1ldGVyLFxuICB9KVxuXG4gIGlmICh0cmlnZ2VyU291cmNlID09PSAnQ3VzdG9tTWVzc2FnZV9TaWduVXAnICYmIHVzZXJBdHRyaWJ1dGVzWydjb2duaXRvOnVzZXJfc3RhdHVzJ10gPT09ICdVTkNPTkZJUk1FRCcpIHtcbiAgICBldmVudC5yZXNwb25zZSA9IGN1c3RvbU1lc3NhZ2Uuc2VuZENvZGVQb3N0U2lnblVwKClcbiAgfVxuXG4gIC8vIFJldHVybiB0byBBbWF6b24gQ29nbml0b1xuICBjYWxsYmFjayhudWxsLCBldmVudClcbn1cbiJdfQ==